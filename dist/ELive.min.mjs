// https://elasticlive.io v0.0.0-development Copyright 2019 RemoteMonster
var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e,t){return e(t={exports:{}},t.exports),t.exports}var i,n=t(function(t,i){(function(){var n={function:!0,object:!0}[typeof window]&&window||this,o=i,a=t&&!t.nodeType&&t,r=o&&a&&"object"==typeof e&&e;!r||r.global!==r&&r.window!==r&&r.self!==r||(n=r);var s=Math.pow(2,53)-1,c=/\bOpera/,d=Object.prototype,l=d.hasOwnProperty,h=d.toString;function u(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function p(e){return e=b(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:u(e)}function f(e,t){for(var i in e)l.call(e,i)&&t(e[i],i,e)}function v(e){return null==e?u(e):h.call(e).slice(8,-1)}function g(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function m(e,t){var i=null;return function(e,t){var i=-1,n=e?e.length:0;if("number"==typeof n&&n>-1&&n<=s)for(;++i<n;)t(e[i],i,e);else f(e,t)}(e,function(n,o){i=t(i,n,o,e)}),i}function b(e){return String(e).replace(/^ +| +$/g,"")}var x=function e(t){var i=n,o=t&&"object"==typeof t&&"String"!=v(t);o&&(i=t,t=null);var a=i.navigator||{},r=a.userAgent||"";t||(t=r);var s,d,l,u,x,y=o?!!a.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(h.toString()),w=o?"Object":"ScriptBridgingProxyObject",S=o?"Object":"Environment",C=o&&i.java?"JavaPackage":v(i.java),O=o?"Object":"RuntimeObject",M=/\bJava/.test(C)&&i.java,I=M&&v(i.environment)==S,E=M?"a":"α",k=M?"b":"β",R=i.document||{},T=i.operamini||i.opera,A=c.test(A=o&&T?T["[[Class]]"]:v(T))?A:T=null,L=t,P=[],j=null,N=t==r,$=N&&T&&"function"==typeof T.version&&T.version(),D=m([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(e,i){return e||RegExp("\\b"+(i.pattern||g(i))+"\\b","i").exec(t)&&(i.label||i)}),F=function(e){return m(e,function(e,i){return e||RegExp("\\b"+(i.pattern||g(i))+"\\b","i").exec(t)&&(i.label||i)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),V=B([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),_=function(e){return m(e,function(e,i,n){return e||(i[V]||i[/^[a-z]+(?: +[a-z]+\b)*/i.exec(V)]||RegExp("\\b"+g(n)+"(?:\\b|\\w*\\d)","i").exec(t))&&n})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),W=function(e){return m(e,function(e,i){var n=i.pattern||g(i);return!e&&(e=RegExp("\\b"+n+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,i){var n={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&i&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(n=n[/[\d.]+$/.exec(e)])&&(e="Windows "+n),e=String(e),t&&i&&(e=e.replace(RegExp(t,"i"),i)),e=p(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,n,i.label||i)),e})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function B(e){return m(e,function(e,i){var n=i.pattern||g(i);return!e&&(e=RegExp("\\b"+n+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+n+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+n+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(i.label&&!RegExp(n,"i").test(i.label)?i.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),i=i.label||i,e=p(e[0].replace(RegExp(n,"i"),i).replace(RegExp("; *(?:"+i+"[_-])?","i")," ").replace(RegExp("("+i+")[-_.]?(\\w)","i"),"$1 $2"))),e})}if(D&&(D=[D]),_&&!V&&(V=B([_])),(s=/\bGoogle TV\b/.exec(V))&&(V=s[0]),/\bSimulator\b/i.test(t)&&(V=(V?V+" ":"")+"Simulator"),"Opera Mini"==F&&/\bOPiOS\b/.test(t)&&P.push("running in Turbo/Uncompressed mode"),"IE"==F&&/\blike iPhone OS\b/.test(t)?(_=(s=e(t.replace(/like iPhone OS/,""))).manufacturer,V=s.product):/^iP/.test(V)?(F||(F="Safari"),W="iOS"+((s=/ OS ([\d_]+)/i.exec(t))?" "+s[1].replace(/_/g,"."):"")):"Konqueror"!=F||/buntu/i.test(W)?_&&"Google"!=_&&(/Chrome/.test(F)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(V))||/\bAndroid\b/.test(W)&&/^Chrome/.test(F)&&/\bVersion\//i.test(t)?(F="Android Browser",W=/\bAndroid\b/.test(W)?W:"Android"):"Silk"==F?(/\bMobi/i.test(t)||(W="Android",P.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&P.unshift("accelerated")):"PaleMoon"==F&&(s=/\bFirefox\/([\d.]+)\b/.exec(t))?P.push("identifying as Firefox "+s[1]):"Firefox"==F&&(s=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(W||(W="Firefox OS"),V||(V=s[1])):!F||(s=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(F))?(F&&!V&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(s+"/")+8))&&(F=null),(s=V||_||W)&&(V||_||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(W))&&(F=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(W)?W:s)+" Browser")):"Electron"==F&&(s=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&P.push("Chromium "+s):W="Kubuntu",$||($=m(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",g(F),"(?:Firefox|Minefield|NetFront)"],function(e,i){return e||(RegExp(i+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null})),(s=("iCab"==D&&parseFloat($)>3?"WebKit":/\bOpera\b/.test(F)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(D)&&"WebKit"||!D&&/\bMSIE\b/i.test(t)&&("Mac OS"==W?"Tasman":"Trident")||"WebKit"==D&&/\bPlayStation\b(?! Vita\b)/i.test(F)&&"NetFront")&&(D=[s]),"IE"==F&&(s=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(F+=" Mobile",W="Windows Phone "+(/\+$/.test(s)?s:s+".x"),P.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(F="IE Mobile",W="Windows Phone 8.x",P.unshift("desktop mode"),$||($=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=F&&"Trident"==D&&(s=/\brv:([\d.]+)/.exec(t))&&(F&&P.push("identifying as "+F+($?" "+$:"")),F="IE",$=s[1]),N){if(u="global",x=null!=(l=i)?typeof l[u]:"number",/^(?:boolean|number|string|undefined)$/.test(x)||"object"==x&&!l[u])v(s=i.runtime)==w?(F="Adobe AIR",W=s.flash.system.Capabilities.os):v(s=i.phantom)==O?(F="PhantomJS",$=(s=s.version||null)&&s.major+"."+s.minor+"."+s.patch):"number"==typeof R.documentMode&&(s=/\bTrident\/(\d+)/i.exec(t))?($=[$,R.documentMode],(s=+s[1]+4)!=$[1]&&(P.push("IE "+$[1]+" mode"),D&&(D[1]=""),$[1]=s),$="IE"==F?String($[1].toFixed(1)):$[0]):"number"==typeof R.documentMode&&/^(?:Chrome|Firefox)\b/.test(F)&&(P.push("masking as "+F+" "+$),F="IE",$="11.0",D=["Trident"],W="Windows");else if(M&&(L=(s=M.lang.System).getProperty("os.arch"),W=W||s.getProperty("os.name")+" "+s.getProperty("os.version")),I){try{$=i.require("ringo/engine").version.join("."),F="RingoJS"}catch(e){(s=i.system)&&s.global.system==i.system&&(F="Narwhal",W||(W=s[0].os||null))}F||(F="Rhino")}else"object"==typeof i.process&&!i.process.browser&&(s=i.process)&&("object"==typeof s.versions&&("string"==typeof s.versions.electron?(P.push("Node "+s.versions.node),F="Electron",$=s.versions.electron):"string"==typeof s.versions.nw&&(P.push("Chromium "+$,"Node "+s.versions.node),F="NW.js",$=s.versions.nw)),F||(F="Node.js",L=s.arch,W=s.platform,$=($=/[\d.]+/.exec(s.version))?$[0]:null));W=W&&p(W)}if($&&(s=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec($)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(N&&a.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(j=/b/i.test(s)?"beta":"alpha",$=$.replace(RegExp(s+"\\+?$"),"")+("beta"==j?k:E)+(/\d+\+?/.exec(s)||"")),"Fennec"==F||"Firefox"==F&&/\b(?:Android|Firefox OS)\b/.test(W))F="Firefox Mobile";else if("Maxthon"==F&&$)$=$.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(V))"Xbox 360"==V&&(W=null),"Xbox 360"==V&&/\bIEMobile\b/.test(t)&&P.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(F)&&(!F||V||/Browser|Mobi/.test(F))||"Windows CE"!=W&&!/Mobi/i.test(t))if("IE"==F&&N)try{null===i.external&&P.unshift("platform preview")}catch(e){P.unshift("embedded")}else(/\bBlackBerry\b/.test(V)||/\bBB10\b/.test(t))&&(s=(RegExp(V.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||$)?(W=((s=[s,/BB10/.test(t)])[1]?(V=null,_="BlackBerry"):"Device Software")+" "+s[0],$=null):this!=f&&"Wii"!=V&&(N&&T||/Opera/.test(F)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==F&&/\bOS X (?:\d+\.){2,}/.test(W)||"IE"==F&&(W&&!/^Win/.test(W)&&$>5.5||/\bWindows XP\b/.test(W)&&$>8||8==$&&!/\bTrident\b/.test(t)))&&!c.test(s=e.call(f,t.replace(c,"")+";"))&&s.name&&(s="ing as "+s.name+((s=s.version)?" "+s:""),c.test(F)?(/\bIE\b/.test(s)&&"Mac OS"==W&&(W=null),s="identify"+s):(s="mask"+s,F=A?p(A.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(s)&&(W=null),N||($=null)),D=["Presto"],P.push(s));else F+=" Mobile";(s=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(s=[parseFloat(s.replace(/\.(\d)$/,".0$1")),s],"Safari"==F&&"+"==s[1].slice(-1)?(F="WebKit Nightly",j="alpha",$=s[1].slice(0,-1)):$!=s[1]&&$!=(s[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||($=null),s[1]=(/\bChrome\/([\d.]+)/i.exec(t)||0)[1],537.36==s[0]&&537.36==s[2]&&parseFloat(s[1])>=28&&"WebKit"==D&&(D=["Blink"]),N&&(y||s[1])?(D&&(D[1]="like Chrome"),s=s[1]||((s=s[0])<530?1:s<532?2:s<532.05?3:s<533?4:s<534.03?5:s<534.07?6:s<534.1?7:s<534.13?8:s<534.16?9:s<534.24?10:s<534.3?11:s<535.01?12:s<535.02?"13+":s<535.07?15:s<535.11?16:s<535.19?17:s<536.05?18:s<536.1?19:s<537.01?20:s<537.11?"21+":s<537.13?23:s<537.18?24:s<537.24?25:s<537.36?26:"Blink"!=D?"27":"28")):(D&&(D[1]="like Safari"),s=(s=s[0])<400?1:s<500?2:s<526?3:s<533?4:s<534?"4+":s<535?5:s<537?6:s<538?7:s<601?8:"8"),D&&(D[1]+=" "+(s+="number"==typeof s?".x":/[.+]/.test(s)?"":"+")),"Safari"==F&&(!$||parseInt($)>45)&&($=s)),"Opera"==F&&(s=/\bzbov|zvav$/.exec(W))?(F+=" ",P.unshift("desktop mode"),"zvav"==s?(F+="Mini",$=null):F+="Mobile",W=W.replace(RegExp(" *"+s+"$"),"")):"Safari"==F&&/\bChrome\b/.exec(D&&D[1])&&(P.unshift("desktop mode"),F="Chrome Mobile",$=null,/\bOS X\b/.test(W)?(_="Apple",W="iOS 4.3+"):W=null),$&&0==$.indexOf(s=/[\d.]+$/.exec(W))&&t.indexOf("/"+s+"-")>-1&&(W=b(W.replace(s,""))),D&&!/\b(?:Avant|Nook)\b/.test(F)&&(/Browser|Lunascape|Maxthon/.test(F)||"Safari"!=F&&/^iOS/.test(W)&&/\bSafari\b/.test(D[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(F)&&D[1])&&(s=D[D.length-1])&&P.push(s),P.length&&(P=["("+P.join("; ")+")"]),_&&V&&V.indexOf(_)<0&&P.push("on "+_),V&&P.push((/^on /.test(P[P.length-1])?"":"on ")+V),W&&(s=/ ([\d.+]+)$/.exec(W),d=s&&"/"==W.charAt(W.length-s[0].length-1),W={architecture:32,family:s&&!d?W.replace(s[0],""):W,version:s?s[1]:null,toString:function(){var e=this.version;return this.family+(e&&!d?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(s=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(L))&&!/\bi686\b/i.test(L)?(W&&(W.architecture=64,W.family=W.family.replace(RegExp(" *"+s),"")),F&&(/\bWOW64\b/i.test(t)||N&&/\w(?:86|32)$/.test(a.cpuClass||a.platform)&&!/\bWin64; x64\b/i.test(t))&&P.unshift("32-bit")):W&&/^OS X/.test(W.family)&&"Chrome"==F&&parseFloat($)>=39&&(W.architecture=64),t||(t=null);var G={};return G.description=t,G.layout=D&&D[0],G.manufacturer=_,G.name=F,G.prerelease=j,G.product=V,G.ua=t,G.version=F&&$,G.os=W||{architecture:null,family:null,version:null,toString:function(){return"null"}},G.parse=e,G.toString=function(){return this.description||""},G.version&&P.unshift($),G.name&&P.unshift(F),W&&F&&(W!=String(W).split(" ")[0]||W!=F.split(" ")[0]&&!V)&&P.push(V?"("+W+")":"on "+W),P.length&&(G.description=P.join(" ")),G}();o&&a?f(x,function(e,t){o[t]=e}):n.platform=x}).call(e)}),o=t(function(e,t){e.exports=function(){var e=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var i=Object.prototype.toString.call(e);return"[object RegExp]"===i||"[object Date]"===i||function(e){return e.$$typeof===t}(e)}(e)},t="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(e,t){return!1!==t.clone&&t.isMergeableObject(e)?a((i=e,Array.isArray(i)?[]:{}),e,t):e;var i}function n(e,t,n){return e.concat(t).map(function(e){return i(e,n)})}function o(e,t,n){var o={};return n.isMergeableObject(e)&&Object.keys(e).forEach(function(t){o[t]=i(e[t],n)}),Object.keys(t).forEach(function(r){n.isMergeableObject(t[r])&&e[r]?o[r]=function(e,t){if(!t.customMerge)return a;var i=t.customMerge(e);return"function"==typeof i?i:a}(r,n)(e[r],t[r],n):o[r]=i(t[r],n)}),o}function a(t,a,r){(r=r||{}).arrayMerge=r.arrayMerge||n,r.isMergeableObject=r.isMergeableObject||e;var s=Array.isArray(a),c=Array.isArray(t),d=s===c;return d?s?r.arrayMerge(t,a,r):o(t,a,r):i(a,r)}return a.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(e,i){return a(e,i,t)},{})},a}()}),a="object"==typeof Reflect?Reflect:null,r=a&&"function"==typeof a.apply?a.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};i=a&&"function"==typeof a.ownKeys?a.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function c(){c.init.call(this)}var d=c;c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var l=10;function h(e){return void 0===e._maxListeners?c.defaultMaxListeners:e._maxListeners}function u(e,t,i,n){var o,a,r,s;if("function"!=typeof i)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i);if(void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),a=e._events),r=a[t]),void 0===r)r=a[t]=i,++e._eventsCount;else if("function"==typeof r?r=a[t]=n?[i,r]:[r,i]:n?r.unshift(i):r.push(i),(o=h(e))>0&&r.length>o&&!r.warned){r.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+r.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=r.length,s=c,console&&console.warn&&console.warn(s)}return e}function p(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},o=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,r(this.listener,this.target,e))}.bind(n);return o.listener=i,n.wrapFn=o,o}function f(e,t,i){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"==typeof o?i?[o.listener||o]:[o]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(o):g(o,o.length)}function v(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function g(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),c.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},c.prototype.getMaxListeners=function(){return h(this)},c.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n="error"===e,o=this._events;if(void 0!==o)n=n&&void 0===o.error;else if(!n)return!1;if(n){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var d=c.length,l=g(c,d);for(i=0;i<d;++i)r(l[i],this,t)}return!0},c.prototype.addListener=function(e,t){return u(this,e,t,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(e,t){return u(this,e,t,!0)},c.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,p(this,e,t)),this},c.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,p(this,e,t)),this},c.prototype.removeListener=function(e,t){var i,n,o,a,r;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(o=-1,a=i.length-1;a>=0;a--)if(i[a]===t||i[a].listener===t){r=i[a].listener,o=a;break}if(o<0)return this;0===o?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,o),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,r||t)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var o,a=Object.keys(i);for(n=0;n<a.length;++n)"removeListener"!==(o=a[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},c.prototype.listeners=function(e){return f(this,e,!0)},c.prototype.rawListeners=function(e){return f(this,e,!1)},c.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):v.call(e,t)},c.prototype.listenerCount=v,c.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]};class m{constructor(){this.token,this.serviceId,this.config,this.channel={id:void 0,name:void 0,peers:[],startTime:void 0,status:void 0,type:void 0,members:[]},this.localVideo,this.remoteMedia,this.remoteMedia2,this.localStream=new MediaStream,this.remoteStream=new MediaStream,this.transceivers=null,this.devices={currentVideoInput:-1,currentAudioInput:-1,videoInput:[],audioInput:[],audioOutput:[]},this.peerConnection,this.dataConnection,this.state,this.isConnectToSig=!1,this.elive,this.callEvent,this.eventManager,this.mediaManager,this.signaler,this.messaging,this.country=void 0}}const b=(()=>{let e,t,i;function n(...t){"SILENT"!==e&&"ERROR"!==e&&"WARN"!==e&&console.info(...t)}return Object.freeze({init:function(n){e=(t=n).config.sdk.logLevel,i=t.config.sdk.url.log},e:function(...t){"SILENT"!==e&&console.error(...t)},w:function(...t){"SILENT"!==e&&"ERROR"!==e&&console.warn(...t)},l:function(...e){n(...e)},i:n,d:function(...t){"SILENT"!==e&&"ERROR"!==e&&"WARN"!==e&&"INFO"!==e&&console.debug(...t)},v:function(...t){"SILENT"!==e&&"ERROR"!==e&&"WARN"!==e&&"INFO"!==e&&"DEBUG"!==e&&console.trace(...t)}})})();class x extends Error{constructor(e,t){super(e),this.name="ELiveError",t&&console.error(t)}}class y{constructor(e){this.ctx=e,this.pc=new RTCPeerConnection(e.config.rtc),this.ctx.dataConnection=this.pc,this.channel}startAnswer(e){b.i("start answer for dc"),this.pc.setRemoteDescription(e).then(()=>{b.d("remote description(offer) for dc is set")}).catch(e=>{throw console.error(e),new x("remote description for dc is wrong")}),"offer"===e.type&&this.pc.createAnswer().then(e=>{this.pc.setLocalDescription(e).then(()=>{b.d("local description(answer) for dc is set");const t=this.ctx.signaler.createMessage({command:"sdp",body:JSON.stringify(e)});t.to=this.ctx.peerConnection.to,t.pctype="DC",this.ctx.signaler.send(t)})}).catch(e=>{throw new x("failed to create answer for dc",e)})}close(){b.d("datachannel is close"),this.pc.close(),this.ctx.dataConnection=null,this.channel=null}setRemoteDesciption(e){this.pc.setRemoteDescription(e).then(()=>{b.i("remote description(answer) is set")}).catch(e=>{throw console.error(e),new x("remote description(answer) is wrong")})}startOffer(){b.d("startOffer is started"),this.channel=this.pc.createDataChannel("chat"),this.channel.onopen=(e=>b.d("datachannel is connected")),this.channel.onmessage=(e=>this.ctx.callEvent({name:"onMessage",param:e.data})),this.pc.createOffer().then(e=>{this.pc.setLocalDescription(e).then(()=>{b.d("local description for dc is set");const t=this.ctx.signaler.createMessage({command:"sdp",body:JSON.stringify(e)});t.to=this.ctx.channel.master,t.pctype="DC",b.v(t),this.ctx.signaler.send(t)})})}listening(){b.d("listening is started"),this.pc.ondatachannel=(e=>{this.channel=e.channel,console.log(this.channel),this.channel.onopen=(e=>b.d("datachannel is connected")),this.channel.onmessage=(e=>this.ctx.callEvent({name:"onMessage",param:e.data}))})}sendMessage(e){b.d(`sendMessage: ${e}`),this.channel&&this.channel.send(e)}}const w=(()=>{return Object.freeze({validateConfig:function(e){if(!e.config.credential||!e.config.credential.serviceId||!e.config.credential.key)throw new x("no credential data")},validateDevices:async function(e){b.d("start gathering available devices");var t=-1,i=-1;e.config.media.video&&e.config.media.video.deviceId&&(t=e.config.media.video.deviceId),e.config.media.audio&&e.config.media.audio.deviceId&&(i=e.config.media.audio.deviceId),await navigator.mediaDevices.enumerateDevices().then(n=>{for(var o=0;o<n.length;o++){const r=n[o];if("videoinput"===r.kind){var a=e.devices.videoInput.push({text:r.label,id:r.deviceId});r.deviceId===t&&(e.devices.currentVideoInput=a-1)}else"audioinput"===r.kind?(a=e.devices.audioInput.push({text:r.label,id:r.deviceId}),r.deviceId===i&&(e.devices.currentAudioInput=a-1)):"audiooutput"===r.kind&&e.devices.audioOutput.push({text:r.label,id:r.deviceId})}}),-1===e.devices.currentVideoInput&&e.devices.videoInput.length>0&&(e.devices.currentVideoInput=0),-1===e.devices.currentAudioInput&&e.devices.audioInput.length>0&&(e.devices.currentAudioInput=0),b.v(e.devices),b.d("finish gathering available devices")},getMusicConfiguration:function(){return{mandatory:{googHighpassFilter:!1,googEchoCancellation:!1,googEchoCancellation2:!1,googAutoGainControl:!1,googAutoGainControl2:!1,googNoiseSuppression:!1,googNoiseSuppression2:!1,googTypingNoiseDetection:!1,echoCancellation:!1},optional:[{googCpuOveruseDetection:!1}]}}})})();class S extends d{constructor(e){super(),this.ctx=e,this.onMessageHandler=null,this.ws,this.MAX_RETRIES=11}init(){b.d("start signaler init"),this.ctx.isConnectToSig=!1,this.ctx.sigMsgHandler=function(e){const t={onCall(t){b.i(`start onCall with chid:${t.channel.id}`),t.pctype&&"DC"===t.pctype||(e.channel=t.channel),e.callEvent({name:"onCall",param:{channel:e.channel}}),e.peerConnection=new RTCPeerConnection(e.config.rtc,e.config.rtc.opt),e.peerConnection.onicecandidate=o,e.localStream.getTracks().forEach(t=>e.peerConnection.addTrack(t,e.localStream)),e.peerConnection.ontrack=d,e.messaging=new y(e),e.messaging.listening(),e.dataConnection.onicecandidate=a,e.peerConnection.oniceconnectionstatechange=s},onCallee(t){b.i(`start onCallee with chid:${t.channel.id}`),t.pctype&&"DC"===t.pctype||(e.channel=t.channel),e.callEvent({name:"onCall",param:{channel:e.channel}}),e.peerConnection=new RTCPeerConnection(e.config.rtc,e.config.rtc.opt),e.peerConnection.onicecandidate=o,e.localStream.getTracks().forEach(t=>e.peerConnection.addTrack(t,e.localStream)),e.peerConnection.ontrack=d,e.peerConnection.oniceconnectionstatechange=s,e.peerConnection.to=e.channel.master,e.peerConnection.onnegotiationneeded=c,e.messaging=new y(e),e.messaging.startOffer(),e.dataConnection.onicecandidate=a,e.peerConnection.createOffer({offerToReceiveAudio:1,offerToReceiveVideo:1}).then(t=>{t.sdp=n(t.sdp,/m=video(:?.*)?/,"H264"),t.sdp=t.sdp.replace("a=fmtp:111 minptime=10;useinbandfec=1","a=fmtp:111 useinbandfec=1;minptime=10;stereo=1;cbr=1;maxaveragebitrate=400000"),e.config.media.video.bitrate&&(t.sdp=i(t.sdp,"video",e.config.media.video.bitrate)),e.peerConnection.setLocalDescription(t).then(()=>{b.d("local description setted");const i=e.signaler.createMessage({command:"sdp",body:JSON.stringify(t)});i.to=e.channel.master,b.d(`local offer msg: ${JSON.stringify(i)}`),e.signaler.send(i)})})},onCast(t){b.i(`start onCast with chid: ${t.channel.id}`),e.channel=t.channel,e.callEvent({name:"onCast",param:{channel:e.channel}}),e.peerConnection=new RTCPeerConnection(e.config.rtc,e.config.rtc.opt),e.peerConnection.onicecandidate=o,e.localStream.getTracks().forEach(t=>e.peerConnection.addTransceiver(t,{direction:"sendonly",streams:[e.localStream]})),e.peerConnection.ontrack=d,e.peerConnection.oniceconnectionstatechange=s,e.peerConnection.to=e.channel.members[0].id,e.peerConnection.onnegotiationneeded=c,e.peerConnection.createOffer({offerToReceiveAudio:0,offerToReceiveVideo:0,voiceActivityDetection:!1}).then(t=>{t.sdp=n(t.sdp,/m=video(:?.*)?/,"H264"),e.config.media.video.bitrate&&(t.sdp=i(t.sdp,"video",e.config.media.video.bitrate)),t.sdp=t.sdp.replace("a=fmtp:111 minptime=10;useinbandfec=1","a=fmtp:111 useinbandfec=1;minptime=10;stereo=1;cbr=1;maxaveragebitrate=128000"),b.d(`local offer: ${JSON.stringify(t)}`),e.peerConnection.setLocalDescription(t).then(()=>{b.d("local description setted");const i=e.signaler.createMessage({command:"sdp",body:JSON.stringify(t)});i.to=e.channel.members[0].id,e.signaler.send(i)})})},onWatch(t){b.i(`start onWatch with chid: ${t.channel.id}`),e.channel=t.channel,e.callEvent({name:"onWatch",param:{channel:e.channel}}),e.peerConnection=new RTCPeerConnection(e.config.rtc,e.config.rtc.opt),e.peerConnection.onicecandidate=o,e.peerConnection.ontrack=d,e.peerConnection.oniceconnectionstatechange=r,e.peerConnection.to=e.channel.members[0].id,e.peerConnection.onnegotiationneeded=c},onSearch(t){if(b.d(`onSearch ${JSON.stringify(t.body)}`),t.body){var i=new Set;t.body.forEach(e=>{i.add(e.id)}),t.body=[...i],e.callEvent({name:"onSearch",param:t.body})}},async onSdp(t){b.d(`onSdp: ${t.body}`);const i=new RTCSessionDescription(JSON.parse(t.body));e.peerConnection.to=t.from,"DC"!==t.pctype?(e.peerConnection.setRemoteDescription(i).then(()=>{b.i("remote description is set")}).catch(e=>{throw new x("remote description is wrong")}),"offer"===i.type&&e.peerConnection.createAnswer().then(t=>{t.sdp=t.sdp.replace("a=fmtp:111 ","a=fmtp:111 useinbandfec=1;minptime=10;stereo=1;cbr=1;maxaveragebitrate=128000"),e.peerConnection.setLocalDescription(t).then(()=>{b.d("local description is set");const i=e.signaler.createMessage({command:"sdp",body:JSON.stringify(t)});i.to=e.peerConnection.to,e.signaler.send(i)})}).catch(e=>{throw new x("failed to create answer",e)})):"offer"===i.type?e.messaging.startAnswer(i):e.messaging.setRemoteDesciption(i)},async onIce(t){const i=new RTCIceCandidate(JSON.parse(t.body));b.d("candidate: ",JSON.stringify(i)),t.pctype&&"DC"===t.pctype?e.dataConnection.addIceCandidate(i):e.peerConnection.addIceCandidate(i)}};function i(e,t,i){for(var n=e.split("\n"),o=-1,a=0;a<n.length;a++)if(0===n[a].indexOf("m="+t)){o=a;break}if(-1===o)return console.debug("Could not find the m line for",t),e;for(console.debug("Found the m line for",t,"at line",o),o++;0===n[o].indexOf("i=")||0===n[o].indexOf("c=");)o++;if(0===n[o].indexOf("b"))return console.debug("Replaced b line at line",o),n[o]="b=AS:"+i,n.join("\n");console.debug("Adding new b line before line",o);var r=n.slice(0,o);return r.push("b=AS:"+i),(r=r.concat(n.slice(o,n.length))).join("\n")}function n(e,t,i){var n,o,a,r=[],s=new RegExp("a=rtpmap:(\\d+) "+i+"/\\d+");if(!(n=e.match(t)))return e;if(!(o=e.match(s)))return e;n=n[0],o=o[1],a=n.split(" "),r.push(a[0]),r.push(a[1]),r.push(a[2]),r.push(o);for(var c=3;c<a.length;c++)a[c]!==o&&r.push(a[c]);return e.replace(n,r.join(" "))}function o(t){console.log("ice candidate is created"),console.log(t.candidate);const i=e.signaler.createMessage({command:"ice",body:JSON.stringify(t.candidate)});i.to=e.peerConnection.to,e.signaler.send(i)}function a(t){console.log("ice candidate for dc is created"),console.log(t.candidate);const i=e.signaler.createMessage({command:"ice",body:JSON.stringify(t.candidate)});i.to=e.peerConnection.to,i.pctype="DC",e.signaler.send(i)}function r(t){if(e&&"CLOSE"!==e.state)switch(b.i(`ice con evt: ${e.peerConnection.iceConnectionState}`),e.peerConnection.iceConnectionState){case"connected":e.remoteStream.getAudioTracks().length>1?(e.remoteMedia.srcObject=new MediaStream([e.remoteStream.getAudioTracks()[0]]),e.remoteMedia2&&(e.remoteMedia2.srcObject=new MediaStream([e.remoteStream.getAudioTracks()[1]]))):e.remoteMedia.srcObject=e.remoteStream,e.state="COMPLETE",e.callEvent({name:"onComplete",param:{channel:e.channel}});break;case"closed":"CLOSE"!==e.state&&e.elive.close();break;case"failed":throw e.state="FAIL",new x("ice connecting is failed");case"disconnected":"CLOSE"!==e.state&&(e.state="CLOSE"),e.callEvent({name:"onClose",param:{}})}}function s(t){if(e&&"CLOSE"!==e.state)switch(b.i(`ice con evt: ${e.peerConnection.iceConnectionState}`),e.peerConnection.iceConnectionState){case"connected":"P2P"===e.channel.type&&(e.signaler.close(),e.isConnectToSig=!1,e.remoteMedia.srcObject=e.remoteStream),e.state="COMPLETE",e.callEvent({name:"onComplete",param:{channel:e.channel}});break;case"closed":"CLOSE"!==e.state&&e.elive.close();break;case"failed":throw e.state="FAIL",new x("ice connecting is failed");case"disconnected":"CLOSE"!==e.state&&e.elive.close()}}function c(e){b.w("negotiation is needed")}function d(t){b.d("received track"),console.dir(t),"track"===t.type&&(e.remoteStream.addTrack(t.track),e.transceivers=e.peerConnection.getTransceivers())}e.signaler.onMessage(function(e){const i=JSON.parse(e.data),n=i.command;b.d(`-> msg: ${i.command}`,i),t[n](i)})}(this.ctx),this.ws=new WebSocket(this.ctx.config.sdk.url.sig),this.ws.onopen=(()=>{b.i("Sig: success connect to sig server"),this.ctx.isConnectToSig=!0,this.ctx.callEvent({name:"init",param:{}})}),this.ws.onerror=(e=>{throw new x("websocket is failed",e)}),this.ws.onclose=(e=>{b.i("websocket is closed")}),this.ws.onmessage=this.onMessageHandler,b.d("finished signaler init")}onMessage(e){this.onMessageHandler=e}async call(e){await this._sendCommand("call",e,"P2P")}async cast(e){await this._sendCommand("cast",e,"BROADCAST")}async watch(e){await this._sendCommand("watch",e,"BROADCAST")}async search(e){await this.waitForConnection();const t=this.createMessage({command:"search"});this.send(t)}async _sendCommand(e,t,i){await this.waitForConnection(),b.i("start "+e),this.ctx.channel.id=t,this.ctx.channel.type=i;const n=this.createMessage({command:e});b.v(n),this.send(n)}send(e){const t=JSON.stringify(e);if(this.ws)try{this.ws.send(t)}catch(e){throw new x("send error",e)}}close(){b.d("signaler is close"),this.ws.close(),this.ctx.isConnectToSig=!1}createMessage({command:e,body:t}){return{command:e,token:this.ctx.token,serviceId:this.ctx.config.credential.serviceId,channel:this.ctx.channel,body:t}}async waitForConnection(){for(let e=5;e<=this.MAX_RETRIES;e++){if(!0===this.ctx.isConnectToSig)return;{const t=Math.pow(2,e);b.d("wating for init %i",e),await this.wait(t)}}}wait(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}}async function C(e){b.d("start auth with context");const t={credential:{key:e.config.credential.key,serviceId:e.config.credential.serviceId},env:{os:n.os.family,osVersion:n.os.version||"0",device:n.name,deviceVersion:n.version||"0",sdkVersion:e.elive.version,country:e.config.sdk&&e.config.sdk.country?e.config.sdk.country:"KR"}},i={method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify(t)};try{const t=await fetch(e.config.sdk.url.auth,i),n=await t.json();b.d("auth response:"),b.d(n),Object.keys(n).forEach(t=>{switch(t){case"iceServers":n[t].forEach(t=>e.config.rtc.iceServers.push(t));break;case"token":e.token=n[t]}})}catch(t){throw console.error(t),new x(`Auth is failed with id:${e.config.credential.serviceId}/ key:${e.config.credential.key}`)}if(!e.token)throw new x(`failed to auth with id: ${e.config.credential.serviceId} and key: ${e.config.credential.key}`);b.d("success auth")}var O={credential:{serviceId:void 0,key:void 0},view:{local:void 0,remote:void 0,remote2:void 0},rtc:{iceServers:[{urls:"stun:stun.l.google.com:19302"}],opt:{},dataOpt:{optional:[{RtpDataChannels:!0}]},sdpSemantics:"unified-plan"},media:{video:{frameRate:{min:20,max:30}},audio:{channelCount:2}},sdk:{url:{sig:"wss://demo.remotemonster.com/sig",auth:"https://signal.remotemonster.com/rest/init",log:"https://signal.remotemonster.com:2001/topics"},logLevel:"INFO",audioType:"voice",mode:"prod"}};class M{constructor(e){this.ctx=e}async captureScreen(){this.ctx.localStream=await navigator.mediaDevices.getDisplayMedia({video:!0}),this.ctx.transceivers[1].sender.replaceTrack(this.ctx.localStream.getTracks()[0]),this.ctx.localStream.addTrack(this.ctx.transceivers[0].sender.track),this.ctx.localVideo.srcObject=this.ctx.localStream}stopCaptureScreen(){showLocalVideo()}async validateDevices(){b.d("start gathering available devices");var e=-1,t=-1;if(this.ctx.config.media.video&&this.ctx.config.media.video.deviceId&&(e=this.ctx.config.media.video.deviceId),this.ctx.config.media.audio&&this.ctx.config.media.audio.deviceId&&(t=this.ctx.config.media.audio.deviceId),await navigator.mediaDevices.enumerateDevices().then(i=>{for(var n=0;n<i.length;n++){const a=i[n];if("videoinput"===a.kind){var o=this.ctx.devices.videoInput.push({text:a.label,id:a.deviceId});a.deviceId===e&&(this.ctx.devices.currentVideoInput=o-1)}else if("audioinput"===a.kind){o=this.ctx.devices.audioInput.push({text:a.label,id:a.deviceId});a.deviceId===t&&(this.ctx.devices.currentAudioInput=o-1)}else"audiooutput"===a.kind&&this.ctx.devices.audioOutput.push({text:a.label,id:a.deviceId})}}),0===this.ctx.devices.videoInput.length||0===this.ctx.devices.audioInput.length)throw new x("there is no input device");-1===this.ctx.devices.currentVideoInput&&this.ctx.devices.videoInput.length>0&&(this.ctx.devices.currentVideoInput=0),-1===this.ctx.devices.currentAudioInput&&this.ctx.devices.audioInput.length>0&&(this.ctx.devices.currentAudioInput=0),document.querySelector("#"+this.ctx.config.view.local)&&(this.ctx.localVideo=document.querySelector("#"+this.ctx.config.view.local)),document.querySelector("#"+this.ctx.config.view.remote)&&(this.ctx.remoteMedia=document.querySelector("#"+this.ctx.config.view.remote)),document.querySelector("#"+this.ctx.config.view.remote2)&&(this.ctx.remoteMedia2=document.querySelector("#"+this.ctx.config.view.remote2)),b.d("finish gathering available devices: ${JSON.stringify(this.ctx.devices)}")}setVideoInput(e){b.d("start to set video input with "+e);const t=this.findDevice(e,this.ctx.devices.videoInput);if(-1==t)throw new x("incorrect video device. input a right video device id.");this.ctx.devices.currentVideoInput=t,this.ctx.config.media.video.deviceId=this.ctx.devices.videoInput[t].id,b.d("finish to set video input with "+e)}setAudioInput(e){b.d("start to set audio input with "+e);const t=this.findDevice(e,this.ctx.devices.audioInput);if(-1==t)throw new x("incorrect audio device. input a right audio device id.");this.ctx.devices.currentAudioInput=t,this.ctx.config.media.audio.deviceId=this.ctx.devices.audioInput[t].id,b.d("finish to set audio input with "+e)}async switchCamera(){b.d("start to switch camera"),this.ctx.devices.videoInput.length<2||(++this.ctx.devices.currentVideoInput===this.ctx.devices.videoInput.length&&(this.ctx.devices.currentVideoInput=0),this.showLocalVideo(this.ctx.devices.videoInput[this.ctx.devices.currentVideoInput].id),this.ctx.config.media.video.deviceId={exact:[this.ctx.devices.videoInput[this.ctx.devices.currentVideoInput].id]},b.d("finish to switch camera"))}muteRemote(e){this.ctx.transceivers&&(this.ctx.transceivers[1].receiver.track.enabled=!e,this.ctx.transceivers[0].receiver.track.enabled=!e)}muteLocal(e){this.ctx.transceivers&&(this.ctx.transceivers[1].sender.track.enabled=!e,this.ctx.transceivers[0].sender.track.enabled=!e)}async showLocalVideo(e){var t;if(b.d(`start to show localvideo with dev id ${e}`),e&&this.setVideoInput(e),!(t=await navigator.mediaDevices.getUserMedia(this.ctx.config.media)))throw new x("can not get user media");this.ctx.localVideo.srcObject=t,this.ctx.localStream=t,this.ctx.callEvent({name:"onDisplayUserMedia",param:t}),null!==this.ctx.transceivers&&this.ctx.transceivers.length>1&&this.ctx.transceivers[1].sender.replaceTrack(this.ctx.localStream.getVideoTracks()[0]),b.d(`finish to show localvideo with dev id ${e}`)}findDevice(e,t){b.d(`start find device ${e}`);for(var i=0;i<t.length;i++){if(t[i].id===e)return i}return b.d(`finish find device ${e}`),-1}setResolution(e,t){this.ctx.config.media.video.width=e,this.ctx.config.media.video.height=t,this.applyRuntime("video")}setFrameRate(e){this.ctx.config.media.video.frameRate=e,this.applyRuntime("video")}setAgc(e){this.ctx.config.media.audio.autoGainControl=e,this.applyRuntime("audio")}setChannelCount(e){this.ctx.config.media.audio.channelCount=e,this.applyRuntime("audio")}setEchoCancellation(e){this.ctx.config.media.audio.echoCancellation=e,this.applyRuntime("audio")}setLatency(e){this.ctx.config.media.audio.latency=e,this.applyRuntime("audio")}setNoiseSuppression(e){this.ctx.config.media.audio.noiseSuppression=e,this.applyRuntime("audio")}setSampleRate(e){this.ctx.config.media.audio.sampleRate=e,this.applyRuntime("audio")}setSampleSize(e){this.ctx.config.media.audio.sampleSize=e,this.applyRuntime("audio")}setVolume(e){this.ctx.config.media.audio.volume=sampleRate,this.applyRuntime("audio"),this.ctx.transceivers&&this.ctx.transceivers[0].receiver.track.applyConstraints({volume:e})}applyRuntime(e){this.ctx.transceivers&&("video"===e?this.ctx.transceivers[1].sender.track.applyConstraints(this.ctx.config.media.video):"audio"===e&&this.ctx.transceivers[0].sender.track.applyConstraints(this.ctx.config.media.audio))}}class I extends d{constructor(e){super(),this.version="3.0",e||(e={}),e.sdk&&"dev"===e.sdk.mode&&(e.sdk.url={sig:"ws://localhost:1235/sig"}),this.ctx=new m,this.ctx.elive=this,this.ctx.config=o(O,e),b.init(this.ctx),this.ctx.callEvent=this.onEvent,this.devManager=new M(this.ctx),this.ctx.signaler=new S(this.ctx),"music"===this.ctx.config.sdk.audioType&&(this.ctx.config.rtc.opt=w.getMusicConfiguration()),w.validateConfig(this.ctx),this.search=this.search.bind(this)}async call(e){0==this.ctx.devices.audioInput.length&&await this.devManager.validateDevices(),await C(this.ctx),await this.devManager.showLocalVideo(),await this.ctx.signaler.init(),this.ctx.signaler.call(e),b.d(`finish to call the ${e} room`)}async cast(e){0==this.ctx.devices.audioInput.length&&await this.devManager.validateDevices(),await C(this.ctx),await this.devManager.showLocalVideo(),await this.ctx.signaler.init(),this.ctx.signaler.cast(e),b.d(`finish to cast the ${e} room`)}async watch(e){this.ctx.remoteMedia=document.querySelector("#"+this.ctx.config.view.remote),this.ctx.remoteMedia2=document.querySelector("#"+this.ctx.config.view.remote2),await C(this.ctx),await this.ctx.signaler.init(),this.ctx.signaler.watch(e),b.d(`finish to call the ${e} room`)}async close(){"CLOSE"===this.ctx.state&&null===this.ctx.peerConnection||(this.ctx.state="CLOSE",this.ctx.isConnectToSig=!1,this.ctx.messaging&&this.ctx.messaging.close(),this.ctx.signaler.close(),this.ctx.peerConnection&&await this.ctx.peerConnection.getTransceivers().forEach(e=>e.direction="inactive"),this.ctx.peerConnection&&(this.ctx.peerConnection.close(),this.ctx.peerConnection=null,this.ctx.remoteStream.getTracks().forEach(e=>this.ctx.remoteStream.removeTrack(e)),this.ctx.transceivers=null,this.ctx.callEvent({name:"onClose",param:{channel:this.ctx.channel}})))}sendMessage(e){this.ctx.messaging.sendMessage(e)}onEvent(e){this.elive.emit(e.name,e.param)}setVideoQuality(e){}setFrameRate(e){this.devManager.setFrameRate(e)}setResolution(e,t){this.devManager.setResolution(e,t)}setAgc(e){this.devManager.setAgc(e)}setChannelCount(e){this.devManager.setChannelCount(e)}setEchoCancellation(e){this.devManager.setEchoCancellation(e)}setLatency(e){this.devManager.setLatency(e)}setNoiseSuppression(e){this.devManager.setNoiseSuppression(e)}setSampleSize(e){this.devManager.setSampleSize(e)}setSampleRate(e){this.devManager.setSampleRate(e)}setVolume(e){this.devManager.setVolume(e)}async captureScreen(){this.devManager.captureScreen()}stopCaptureScreen(){this.devManager.stopCaptureScreen()}async setVideoInput(e){0==this.ctx.devices.audioInput.length&&await this.devManager.validateDevices(),this.devManager.setVideoInput(e)}async setAudioInput(e){0==this.ctx.devices.audioInput.length&&await this.devManager.validateDevices(),this.devManager.setAudioInput(e)}async showLocalVideo(e){0==this.ctx.devices.audioInput.length&&await this.devManager.validateDevices(),await this.devManager.showLocalVideo(e)}async switchCamera(){0==this.ctx.devices.audioInput.length&&await this.devManager.validateDevices(),this.devManager.switchCamera()}muteRemote(e){this.devManager.muteRemote(e)}muteLocal(e){this.devManager.muteLocal(e)}getDevices(){return this.ctx.devices}getHealth(){}getState(){}getRoomId(){return this.ctx.channel.id}async search(e){this.ctx&&(this.ctx.signaler&&!this.ctx.isConnectToSig&&(await C(this.ctx),await this.ctx.signaler.init()),this.ctx&&this.ctx.signaler&&this.ctx.signaler.search(e))}status(){return{version:this.version,platform:n.name,platformVersion:n.version}}}I.version="0.0.0-development",I.env="prod";export default I;
